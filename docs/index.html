<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Empirical Bayes Matrix Factorization • flashier</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Empirical Bayes Matrix Factorization">
<meta property="og:description" content="Methods for matrix factorization based on Wang and Stephens (2021) 
    &lt;https://jmlr.org/papers/v22/20-589.html&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">flashier</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.53</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="articles/index.html">Vignettes</a>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/willwerscheid/flashier" class="external-link">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="flashier">flashier<a class="anchor" aria-label="anchor" href="#flashier"></a>
</h1></div>
<p>Documentation and vignettes are available <a href="https://willwerscheid.github.io/flashier/" class="external-link">here</a>.</p>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>Install the latest version of flashier from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"willwerscheid/flashier"</span><span class="op">)</span></span></code></pre></div>
<p>Once you have installed the package, load the package in R:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/willwerscheid/flashier" class="external-link">flashier</a></span><span class="op">)</span></span></code></pre></div>
<p>Next, run an example analysis of the GTEx data set:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gtex</span><span class="op">)</span></span>
<span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/flash.html">flash</a></span><span class="op">(</span><span class="va">gtex</span>,greedy_Kmax <span class="op">=</span> <span class="fl">3</span>,backfit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>For a more detailed introduction to flashier, see the <a href="https://willwerscheid.github.io/flashier/articles/flashier_intro.html" class="external-link">introductory vignette</a> and, later, the <a href="https://willwerscheid.github.io/flashier/articles/index.html" class="external-link">other vignettes</a>.</p>
<p>To learn more, visit the <a href="https://willwerscheid.github.io/flashier/" class="external-link">package website</a>, and view the “flash” help page in R:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="st">"flash"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="citing-this-work">Citing this work<a class="anchor" aria-label="anchor" href="#citing-this-work"></a>
</h2>
<p>If you find the flashier package or any of the source code in this repository useful for your work, please cite:</p>
<blockquote>
<p>Jason Willwerscheid, Peter Carbonetto and Matthew Stephens. ebnm: an R package for solving the empirical Bayes normal means problem using a variety of prior families. <a href="https://arxiv.org/abs/2110.00152" class="external-link">arXiv:2110.00152</a>.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>Copyright (c) 2018-2024, Jason Willwerscheid, Peter Carbonetto and Matthew Stephens.</p>
<p>All source code and software in this repository are made available under the terms of the <a href="https://opensource.org/licenses/mit-license.html" class="external-link">MIT license</a>.</p>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<p>Please note that function names changed in flashier version 0.2.44. If you are using flashier code from previous versions, please make the following substitutions, and note that many parameter names have changed as well:</p>
<table class="table">
<thead><tr class="header">
<th>Old Name</th>
<th>New Name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>as.ebnm.fn</td>
<td>flash_ebnm</td>
</tr>
<tr class="even">
<td>conv.crit.elbo</td>
<td>flash_conv_crit_elbo_diff</td>
</tr>
<tr class="odd">
<td>conv.crit.factors</td>
<td>flash_conv_crit_max_chg_F</td>
</tr>
<tr class="even">
<td>conv.crit.loadings</td>
<td>flash_conv_crit_max_chg_L</td>
</tr>
<tr class="odd">
<td>display.elbo</td>
<td>flash_verbose_elbo</td>
</tr>
<tr class="even">
<td>display.elbo.diff</td>
<td>flash_verbose_elbo_diff</td>
</tr>
<tr class="odd">
<td>display.F.max.chg</td>
<td>flash_verbose_max_chg_F</td>
</tr>
<tr class="even">
<td>display.L.max.chg</td>
<td>flash_verbose_max_chg_L</td>
</tr>
<tr class="odd">
<td>display.max.chg</td>
<td>flash_verbose_max_chg</td>
</tr>
<tr class="even">
<td>ff.elbo</td>
<td>flash_fit_get_elbo</td>
</tr>
<tr class="odd">
<td>ff.est.tau</td>
<td>flash_fit_get_est_tau</td>
</tr>
<tr class="even">
<td>ff.fixed.tau</td>
<td>flash_fit_get_fixed_tau</td>
</tr>
<tr class="odd">
<td>ff.g</td>
<td>flash_fit_get_g</td>
</tr>
<tr class="even">
<td>ff.KL</td>
<td>flash_fit_get_KL</td>
</tr>
<tr class="odd">
<td>ff.p2m</td>
<td>flash_fit_get_p2m</td>
</tr>
<tr class="even">
<td>ff.pm</td>
<td>flash_fit_get_pm</td>
</tr>
<tr class="odd">
<td>ff.tau</td>
<td>flash_fit_get_tau</td>
</tr>
<tr class="even">
<td>flash.add.greedy</td>
<td>flash_greedy</td>
</tr>
<tr class="odd">
<td>flash.backfit</td>
<td>flash_backfit</td>
</tr>
<tr class="even">
<td>flash.fit</td>
<td>flash_fit</td>
</tr>
<tr class="odd">
<td>flash.fix.factors</td>
<td>flash_factors_fix</td>
</tr>
<tr class="even">
<td>flash.init</td>
<td>flash_init</td>
</tr>
<tr class="odd">
<td>flash.init.factors</td>
<td>flash_factors_init</td>
</tr>
<tr class="even">
<td>flash.nullcheck</td>
<td>flash_nullcheck</td>
</tr>
<tr class="odd">
<td>flash.remove.factors</td>
<td>flash_factors_remove</td>
</tr>
<tr class="even">
<td>flash.reorder.factors</td>
<td>flash_factors_reorder</td>
</tr>
<tr class="odd">
<td>flash.set.factors.to.zero</td>
<td>flash_factors_set_to_zero</td>
</tr>
<tr class="even">
<td>flash.set.verbose</td>
<td>flash_set_verbose</td>
</tr>
<tr class="odd">
<td>init.fn.default</td>
<td>flash_greedy_init_default</td>
</tr>
<tr class="even">
<td>init.fn.irlba</td>
<td>flash_greedy_init_irlba</td>
</tr>
<tr class="odd">
<td>init.fn.softImpute</td>
<td>flash_greedy_init_softImpute</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="credits">Credits<a class="anchor" aria-label="anchor" href="#credits"></a>
</h2>
<p>The flashier R package was developed by Jason Willwerscheid, Peter Carbonetto and Matthew Stephens, with many other contributors.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=flashier" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/willwerscheid/flashier/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/willwerscheid/flashier/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/BSD-3-Clause" class="external-link">BSD_3_clause</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing flashier</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jason Willwerscheid <br><small class="roles"> Author, maintainer </small>  </li>
<li>Peter Carbonetto <br><small class="roles"> Author </small>  </li>
<li>Wei Wang <br><small class="roles"> Author </small>  </li>
<li>Matthew Stephens <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Jason Willwerscheid, Peter Carbonetto, Wei Wang, Matthew Stephens.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
